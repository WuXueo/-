## 十二、MySQL数据类型精讲

### 1. MySQL中的数据类型

![image-20230605185221679](D:\typora\mysql笔记\img\数据类型1.png)

常见的数据类型：

![image-20230605185613732](D:\typora\mysql笔记\img\常见的数据类型.png)

### 2. 整数介绍

#### 2.1 类型介绍

整数类型一共5种：包括tinyint、smallint、mediumint、int、bigint 	

他们的区别如下：

![image-20230605190119792](D:\typora\mysql笔记\img\整数类型间的区别.png)

#### 2.2 可选属性

整数类型的可选属性有三个：

##### 2.2.1 M(不推荐使用)

M：显示宽度，M的取值范围是（0，255）

**注意：**

1.配合宽度使用 当insert的值不足数值时，使用0填充

2.当使用zerofill时，自动添加undefined

##### 2.2.2 unsigned

无符号

#### 2.3 使用场景

tinyint:一般用于枚举数据，比如系统设定取值范围很小且固定的场景

smallint:可以用于较小范围的统计数据，比如统计工厂的固定资产库存数量

mediuint:用于较大整数的计算，比如车站每日的客流量

int:取值范围足够大，一般情况下不用考虑超限问题，比如商品编号

bigint:只有当你处理特别巨大的整数时才会用到，比如双十一的交易量、大型网站点击量、证券公司衍生产品持仓等

#### 2.4 如何选择？

考虑存储空间和可靠性

### 3. 浮点类型

#### 3.1 类型介绍

浮点数和定点数的特点是可以处理小数，可以把整数看作小数的一个特例。

float、double、real

- float:表示的单精度浮点数
- double：表示双精度浮点数

![image-20230605192456723](D:\typora\mysql笔记\img\double和float区别.png)

- real：默认就是double。如果sql模式设置为启动'real_as_foat'，那么默认就是foat

```
set sql_mode = 'real_as_float';			//启动real_as_float
```

**区别：**

float占用字节数少，取值范围小

double 占用字节数大，取值范围大

#### 3.2 数据精度说明

浮点类型也可以加unsigned,但不会改变数据范围

如果小数位超出范围，存在四舍五入

#### 3.3 精度误差

存在精度丢失

浮点类型是不准确的，所以我们避免使用= 来判断两个数是否相等 

解决方法：使用定点数decimal

### 4. 定点数类型

#### 4.1 类型介绍

MySQL中的定点数类型只有decimal一种类型

| 数据类型                 | 字节数    | 含义               |
| ------------------------ | --------- | ------------------ |
| decimal(M,D),DEC,numeric | M+2个字节 | 有效范围由M和D决定 |

使用decimal（M,D）的方式表示高精度小数

**最大的取值范围与double类型一样**

定点数在mysql内部是以字符串的形式进行存储的

### 5. 位类型：BIT

BIT类型中存储的是二进制值，类似010110

![image-20230605194031743](D:\typora\mysql笔记\img\二进制.png)

使用select命令查询位字段时，可以用BIN（）或HEX（）函数进行读取

### 6. 日期与时间类型

year:用来表示年

date:用来表示年、月、日

time:用来表示年、月、日、时、分、秒

timestamp:用来表示带时区的年、月、日、时、分、秒

![image-20230605194625335](D:\typora\mysql笔记\img\日期与时间类型.png)

#### 6.1 year类型

用来表示年份

在MySQL种，year有几种存储格式：

以4位字符串或数字格式表示year类型，其格式为YYYY

以2为字符串表示year类型，最小值为00，最大值为99**（不推荐）**

当取值01到69时，表示2001-2069

当取值为70到99时，表示1970-1999

当取值整数的0或00添加的话，那么是0000年

当取值是日期/字符串的‘0’添加的话，是2000年

#### 6.2 date类型

格式：YYYY-MM-DD、

需要3个字节的存储空间

使用current_date() 或者 now()  获取当前系统时间

#### 6.3 time类型

需要3个字节

格式：HH:MM:SS

使用current_time() 或 now() 插入当前系统时间

#### 6.4 datetime 类型（用的最多）

需要8个字节

格式：YYYY-MM-DD HH:MM:SS

使用函数current_timestamp() 和 now() 插入系统的当前日期和时间

#### 6.5 timestamp类型

需要4个字节

但是只能存储1970-01-01 00：00：01 UTC到2038-01-19 03：14：07 UTC

格式：YYYY-MM-DD HH:MM:SS

**存储数据的时候需要对当前的时区进行转换，查询数据的时候再将时间转换回当前的时区。**

**因此，使用timestamp存储的同一个时间值，在不同的时区查询时会显示不同的时间**

**- timestamp和timedate的区别:**

- timestamp的存储空间比较小，表示的日期时间范围也比较小
- 底层存储方式不同，timestamp底层存储的是毫秒值
- 两个日期比较大小或日期计算时，timestamp更方便、更快
- timestamp和时区有关。timestamp会根据用户的时区不同，显示不同结果。而datetime只能反应插入当时的时区，其他时区的人查看数据必然有误差的

#### 6.6 开发经验

用的最多是datetime

一般存注册时间、发布时间 用时间戳

### 7. 文本字符串类型

文本字符串分为char、varchar、tinytext、text、mediumtext、longtext、enum、set

![image-20230607105653285](D:\typora\mysql笔记\img\文本字符串类型.png)

#### 7.1 char与varchar类型

char和varchar都可以在存储比较短的字符串

| 字符串（文本）类型 | 特点     | 长度 | 长度范围    | 占用存储空间         |
| ------------------ | -------- | ---- | ----------- | -------------------- |
| char(M)            | 固定长度 | M    | 0<=M<=255   | M个字节              |
| varchar(M)         | 可变长度 | M    | 0<=M<=65535 | （实际长度+1）个字节 |

- char类型

char(M)类型一般需要预定义字符串长度。如果不指定（M），则表示长度默认1个字符

如果保存时，数据的实际长度比char类型申明的长度小，则会在右侧填充空格以达到指定的长度。当mysql检索char类型的数据时，char类型的字段会去除尾部的空格。

定义char类型字段时，声明的字段长度即为char类型字段所占的存储空间的字节数

- varchar类型

varchar定义时，必须指定长度M，否则报错

检错varchar类型的字段数据时，会保留数据尾部的空格。varchar类型的字段占用的存储空间为字符串实际长度加1个字节

**注意：**在UTF8字符集下，一个中文字符占用3个字节，一个英文符占用1个字节

- 哪些情况使用char或varchar更好

| 类型       | 特点     | 空间上       | 时间上 | 使用场景             |
| ---------- | -------- | ------------ | ------ | -------------------- |
| char(M)    | 固定长度 | 浪费存储空间 | 效率高 | 存储不大，速度要求高 |
| varchar(M) | 可变长度 | 节省存储空间 | 效率低 | 非char情况           |

- 具体存储引擎的情况：

MyISAM数据存储引擎的数据列：MyISAM数据表，最好使用固定长度（CHAR）的数据列代替可变长度（VARCHAR）的数据列。这样使得整个表静态化，从而使数据检索更快，用空间换时间

MEMORY存储引擎和数据列：memory数据表目前都使用固定长度的数据行存储，因此无论使用char或varchar列都没有关系，两者都是作为char类型处理的

InnoDB存储引擎，建议使用varchar类型，因为对于InnoDB数据表，内部的行存储格式并没有	区分固定长度、和可变长度列，而且主要影响性能的因素是数据行使用的存储总量

#### 7.2 text类型

text用来保存文本类型的字符串，总共包含4种类型：分别为tinytext、text、mediumtext、longtext

![image-20230607114441348](C:\Users\26561\AppData\Roaming\Typora\typora-user-images\image-20230607114441348.png)

**由于实际存储的长度不确定，mysql不允许text类型的字段做主键**

### 8. enum类型

enum类型也叫做枚举类型，enum类型的取值范围需要在定义字段时进行指定

| 文本字符串类型 | 长度 | 长度范围    | 占用的存储空间 |
| -------------- | ---- | ----------- | -------------- |
| ENUM           | L    | 1<=l<=65535 | 1或2个字节     |

当enum类型包含1~255个成员时，需要1个字节的存储空间

当enum类型包含256~65535个成员时，需要2个字节的存储空间

enum类型的成员个数的上限为65535个

### 9. set类型

set 表示一个字符对象，可以包含0个或多个成员，但成员个数的上限是64

当set类型包含的成员个数不同时，其所占用的存储空间也是不同

![image-20230607120109526](D:\typora\mysql笔记\img\set类型.png)

**set类型在存储数据时成员个数越多，其占用的存储空间越大。**

**注意：**set类型在选取成员时，可以一次选择多个成员，与enum类型不同

### 10. 二进制字符串类型

MySQL的二进制字符串类型主要存储一些二进制数据。比如可以存储图片、音频和视频

##### binary与varbinary

binary 为固定长度的二进制字符串

##### BLOB类型

BLOB是一个二进制对象

![image-20230607144454489](D:\typora\mysql笔记\img\blob类型.png)

### 11. JSON类型

json是一种轻量级的数据交换格式

**json可以将JavaScript对象中表示的一组数据转换为字符串，然后可以在网络或者程序之间轻松的传递这个字符串，并在需要的时候将他还原为各编程语言所支持的数据格式**

### 12. 小结及选择建议

在定义数据类型时，如果确定是整数，就用INT；如果时小数，一定用定点类型decimal；如果时日期与时间，就用datetime



